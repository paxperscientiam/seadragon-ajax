!function(ve,ye,We,y){ve.Seadragon||(ve.Seadragon={});var w=ve.Seadragon,Ge=w.Config;Ge||(Ge=w.Config={debugMode:!1,animationTime:1.5,blendTime:.5,alwaysBlend:!1,autoHideControls:!0,constrainDuringPan:!0,immediateRender:!1,logarithmicZoom:!0,wrapHorizontal:!1,wrapVertical:!1,wrapOverlays:!1,transformOverlays:!1,minZoomDimension:null,minZoomImageRatio:.8,maxZoomPixelRatio:2,visibilityRatio:.8,springStiffness:5,imageLoaderLimit:2,clickTimeThreshold:200,clickDistThreshold:5,zoomPerClick:2,zoomPerScroll:We.pow(2,1/3),zoomPerSecond:2,proxyUrl:null,imagePath:"img/"});var we=w.Strings;we||((we=w.Strings={Errors:{Failure:"Sorry, but Seadragon Ajax can't run on your browser!\nPlease try using IE 8 or Firefox 3.\n",Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Empty:"You asked us to open nothing, so we did just that.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",Unknown:"Whoops, something inexplicably went wrong. Sorry!"},Messages:{Loading:"Loading..."},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in (you can also use your mouse's scroll wheel)",ZoomOut:"Zoom out (you can also use your mouse's scroll wheel)"}}).getString=function(e){for(var t=e.split("."),n=we,i=0;i<t.length;i++)n=n[t[i]]||{};"string"!=typeof n&&(n="");var o=arguments;return n.replace(/\{\d+\}/g,function(e){var t=parseInt(e.match(/\d+/))+1;return t<o.length?o[t]:""})},we.setString=function(e,t){for(var n=e.split("."),i=we,o=0;o<n.length-1;o++)i[n[o]]||(i[n[o]]={}),i=i[n[o]];i[n[o]]=t});var xe=function(){this.log=function(e,t){var n=ve.console||{},i=Ge.debugMode;i&&n.log?n.log(e):i&&t&&alert(e)},this.error=function(e,t){var n=ve.console||{},i=Ge.debugMode;if(i&&n.error?n.error(e):i&&alert(e),i)throw t||new Error(e)},this.fail=function(e){throw alert(we.getString("Errors.Failure")),new Error(e)}};xe=w.Debug=new xe;var Te=w.Profiler=function(){var t=this,n=!1,i=0,o=null,r=null,l=1/0,a=0,s=0,u=1/0,c=0,h=0;this.getAvgUpdateTime=function(){return a},this.getMinUpdateTime=function(){return l},this.getMaxUpdateTime=function(){return s},this.getAvgIdleTime=function(){return c},this.getMinIdleTime=function(){return u},this.getMaxIdleTime=function(){return h},this.isMidUpdate=function(){return n},this.getNumUpdates=function(){return i},this.beginUpdate=function(){if(n&&t.endUpdate(),n=!0,o=(new Date).getTime(),!(i<1)){var e=o-r;c=(c*(i-1)+e)/i,e<u&&(u=e),h<e&&(h=e)}},this.endUpdate=function(){if(n){r=(new Date).getTime(),n=!1;var e=r-o;a=(a*(++i-1)+e)/i,e<l&&(l=e),s<e&&(s=e)}},this.clearProfile=function(){n=!1,r=o=null,l=1/(i=0),u=1/(s=a=0),h=c=0}},qe=w.Point;!function(){if(!qe){var e=(qe=w.Point=function(e,t){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0}).prototype;e.plus=function(e){return new qe(this.x+e.x,this.y+e.y)},e.minus=function(e){return new qe(this.x-e.x,this.y-e.y)},e.times=function(e){return new qe(this.x*e,this.y*e)},e.divide=function(e){return new qe(this.x/e,this.y/e)},e.negate=function(){return new qe(-this.x,-this.y)},e.distanceTo=function(e){return We.sqrt(We.pow(this.x-e.x,2)+We.pow(this.y-e.y,2))},e.apply=function(e){return new qe(e(this.x),e(this.y))},e.equals=function(e){return e instanceof qe&&this.x===e.x&&this.y===e.y},e.toString=function(){return"("+this.x+","+this.y+")"}}}();var x=w.Rect;!function(){if(!x){var e=(x=w.Rect=function(e,t,n,i){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0,this.width="number"==typeof n?n:0,this.height="number"==typeof i?i:0}).prototype;e.getAspectRatio=function(){return this.width/this.height},e.getTopLeft=function(){return new qe(this.x,this.y)},e.getBottomRight=function(){return new qe(this.x+this.width,this.y+this.height)},e.getCenter=function(){return new qe(this.x+this.width/2,this.y+this.height/2)},e.getSize=function(){return new qe(this.width,this.height)},e.equals=function(e){return e instanceof x&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height},e.toString=function(){return"["+this.x+","+this.y+","+this.width+"x"+this.height+"]"}}}();var e=w.Spring=function(e){var t="number"==typeof e?e:0,n=t,i=t,o=(new Date).getTime(),r=o,l=o;this.getCurrent=function(){return t},this.getTarget=function(){return i},this.resetTo=function(e){n=i=e,r=l=o},this.springTo=function(e){n=t,i=e,l=(r=o)+1e3*Ge.animationTime},this.shiftBy=function(e){n+=e,i+=e},this.update=function(){o=(new Date).getTime(),t=l<=o?i:n+(i-n)*function(e){var t=Ge.springStiffness;return(1-We.exp(-e*t))/(1-We.exp(-t))}((o-r)/(l-r))}},Ye=w.Browser={UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},Ke=function(){var r=this,l=["Msxml2.XMLHTTP","Msxml3.XMLHTTP","Microsoft.XMLHTTP"],t={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},g=Ye.UNKNOWN,d=0,p=!1,m={};function o(e,t){return t&&e!=ye.body?ye.body:e.offsetParent}!function(){var e=navigator.appName,t=navigator.appVersion,n=navigator.userAgent;if("Microsoft Internet Explorer"==e&&ve.attachEvent&&ve.ActiveXObject){var i=n.indexOf("MSIE");g=Ye.IE,d=parseFloat(n.substring(i+5,n.indexOf(";",i)));var o=ye.documentMode;void 0!==o&&(d=o)}else if("Netscape"==e&&ve.addEventListener){var r=n.indexOf("Firefox"),l=n.indexOf("Safari"),a=n.indexOf("Chrome");if(0<=r)g=Ye.FIREFOX,d=parseFloat(n.substring(r+8));else if(0<=l){var s=n.substring(0,l).lastIndexOf("/");g=0<=a?Ye.CHROME:Ye.SAFARI,d=parseFloat(n.substring(s+1,l))}}else"Opera"==e&&ve.opera&&ve.attachEvent&&(g=Ye.OPERA,d=parseFloat(t));for(var u=ve.location.search.substring(1).split("&"),c=0;c<u.length;c++){var h=u[c],f=h.indexOf("=");0<f&&(m[h.substring(0,f)]=decodeURIComponent(h.substring(f+1)))}p=g==Ye.IE&&d<9||g==Ye.CHROME&&d<2}(),this.getBrowser=function(){return g},this.getBrowserVersion=function(){return d},this.getElement=function(e){return"string"==typeof e&&(e=ye.getElementById(e)),e},this.getElementPosition=function(e){e=r.getElement(e);for(var t=new qe,n="fixed"==r.getElementStyle(e).position,i=o(e,n);i;)t.x+=e.offsetLeft,t.y+=e.offsetTop,n&&(t=t.plus(r.getPageScroll())),i=o(e=i,n="fixed"==r.getElementStyle(e).position);return t},this.getElementSize=function(e){e=r.getElement(e);return new qe(e.clientWidth,e.clientHeight)},this.getElementStyle=function(e){return(e=r.getElement(e)).currentStyle?e.currentStyle:ve.getComputedStyle?ve.getComputedStyle(e,""):void xe.fail("Unknown element style, no known technique.")},this.getEvent=function(e){return e||ve.event},this.getMousePosition=function(e){e=r.getEvent(e);var t=new qe;return"DOMMouseScroll"==e.type&&g==Ye.FIREFOX&&d<3?(t.x=e.screenX,t.y=e.screenY):"number"==typeof e.pageX?(t.x=e.pageX,t.y=e.pageY):"number"==typeof e.clientX?(t.x=e.clientX+ye.body.scrollLeft+ye.documentElement.scrollLeft,t.y=e.clientY+ye.body.scrollTop+ye.documentElement.scrollTop):xe.fail("Unknown event mouse position, no known technique."),t},this.getMouseScroll=function(e){var t=0;return"number"==typeof(e=r.getEvent(e)).wheelDelta?t=e.wheelDelta:"number"==typeof e.detail?t=-1*e.detail:xe.fail("Unknown event mouse scroll, no known technique."),t?t/We.abs(t):0},this.getPageScroll=function(){var e=new qe,t=ye.documentElement||{},n=ye.body||{};return"number"==typeof ve.pageXOffset?(e.x=ve.pageXOffset,e.y=ve.pageYOffset):n.scrollLeft||n.scrollTop?(e.x=n.scrollLeft,e.y=n.scrollTop):(t.scrollLeft||t.scrollTop)&&(e.x=t.scrollLeft,e.y=t.scrollTop),e},this.getWindowSize=function(){var e=new qe,t=ye.documentElement||{},n=ye.body||{};return"number"==typeof ve.innerWidth?(e.x=ve.innerWidth,e.y=ve.innerHeight):t.clientWidth||t.clientHeight?(e.x=t.clientWidth,e.y=t.clientHeight):n.clientWidth||n.clientHeight?(e.x=n.clientWidth,e.y=n.clientHeight):xe.fail("Unknown window size, no known technique."),e},this.imageFormatSupported=function(e){return!!t[(e=e||"").toLowerCase()]},this.makeCenteredNode=function(e){e=Ke.getElement(e);var t=r.makeNeutralElement("div"),n=[];n.push('<div style="display:table; height:100%; width:100%;'),n.push("border:none; margin:0px; padding:0px;"),n.push('#position:relative; overflow:hidden; text-align:left;">'),n.push('<div style="#position:absolute; #top:50%; width:100%; '),n.push("border:none; margin:0px; padding:0px;"),n.push('display:table-cell; vertical-align:middle;">'),n.push('<div style="#position:relative; #top:-50%; width:100%; '),n.push("border:none; margin:0px; padding:0px;"),n.push('text-align:center;"></div></div></div>'),t.innerHTML=n.join("");for(var i=t=t.firstChild,o=t.getElementsByTagName("div");0<o.length;)o=(i=o[0]).getElementsByTagName("div");return i.appendChild(e),t},this.makeNeutralElement=function(e){var t=ye.createElement(e),n=t.style;return n.background="transparent none",n.border="none",n.margin="0px",n.padding="0px",n.position="static",t},this.makeTransparentImage=function(e){var t=r.makeNeutralElement("img"),n=null;return g==Ye.IE&&d<7?((n=r.makeNeutralElement("span")).style.display="inline-block",t.onload=function(){n.style.width=n.style.width||t.width+"px",n.style.height=n.style.height||t.height+"px",t.onload=null,t=null},t.src=e,n.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"', sizingMethod='scale')"):(n=t).src=e,n},this.setElementOpacity=function(e,t,n){e=r.getElement(e);n&&p&&(t=We.round(t)),e.style.opacity=t<1?t:"";var i=e.style.filter||"";if(e.style.filter=i.replace(/[\s]*alpha\(.*?\)[\s]*/g,""),!(1<=t)){var o=" alpha(opacity="+We.round(100*t)+") ";e.style.filter+=o}},this.addEvent=function(e,t,n,i){(e=r.getElement(e)).addEventListener?("mousewheel"==t&&e.addEventListener("DOMMouseScroll",n,i),e.addEventListener(t,n,i)):e.attachEvent?(e.attachEvent("on"+t,n),i&&e.setCapture&&e.setCapture()):xe.fail("Unable to attach event handler, no known technique.")},this.removeEvent=function(e,t,n,i){(e=r.getElement(e)).removeEventListener?("mousewheel"==t&&e.removeEventListener("DOMMouseScroll",n,i),e.removeEventListener(t,n,i)):e.detachEvent?(e.detachEvent("on"+t,n),i&&e.releaseCapture&&e.releaseCapture()):xe.fail("Unable to detach event handler, no known technique.")},this.cancelEvent=function(e){(e=r.getEvent(e)).preventDefault&&e.preventDefault(),e.cancel=!0,e.returnValue=!1},this.stopEvent=function(e){(e=r.getEvent(e)).stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},this.createCallback=function(n,i){for(var o=[],e=2;e<arguments.length;e++)o.push(arguments[e]);return function(){for(var e=o.concat([]),t=0;t<arguments.length;t++)e.push(arguments[t]);return i.apply(n,e)}},this.getUrlParameter=function(e){var t=m[e];return t||null},this.makeAjaxRequest=function(e,t){var n="function"==typeof t,i=null;if(n){var o=t;t=function(){ve.setTimeout(Ke.createCallback(null,o,i),1)}}if(ve.ActiveXObject)for(var r=0;r<l.length;r++)try{i=new ActiveXObject(l[r]);break}catch(e){continue}else ve.XMLHttpRequest&&(i=new XMLHttpRequest);i||xe.fail("Browser doesn't support XMLHttpRequest."),Ge.proxyUrl&&(e=Ge.proxyUrl+e),n&&(i.onreadystatechange=function(){4==i.readyState&&(i.onreadystatechange=new Function,t())});try{i.open("GET",e,n),i.send(null)}catch(e){xe.log(e.name+" while making AJAX request: "+e.message),i.onreadystatechange=null,i=null,n&&t()}return n?null:i},this.parseXml=function(e){var t=null;if(ve.ActiveXObject)try{(t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e)}catch(e){xe.log(e.name+" while parsing XML (ActiveX): "+e.message)}else if(ve.DOMParser)try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(e){xe.log(e.name+" while parsing XML (DOMParser): "+e.message)}else xe.fail("Browser doesn't support XML DOM.");return t}};Ke=w.Utils=new Ke;var Ee=w.MouseTracker;!function(){if(!Ee){var O=Ke.getBrowser()==Ye.IE&&Ke.getBrowserVersion()<9,S=!1,C=!1,M={},H=[];O?(Ke.addEvent(ye,"mousedown",e,!1),Ke.addEvent(ye,"mouseup",t,!1)):(Ke.addEvent(ve,"mousedown",e,!0),Ke.addEvent(ve,"mouseup",t,!0)),Ee=w.MouseTracker=function(r){var l=this,t=null,o=We.random(),n=(r=Ke.getElement(r),!1),i=!1,a=!1,s=!1,u=null,c=null,h=null;function f(){i&&(O?(Ke.removeEvent(r,"mousemove",E,!0),Ke.removeEvent(r,"mouseup",y,!0),Ke.addEvent(r,"mouseup",v,!1)):(Ke.removeEvent(ve,"mousemove",T,!0),Ke.removeEvent(ve,"mouseup",w,!0)),i=!1)}function g(e,t){var n=M;for(var i in n)n.hasOwnProperty(i)&&o!=i&&n[i][e](t)}function e(){return s}function d(e){e=Ke.getEvent(e);O&&i&&!P(e.srcElement,r)&&g("onMouseOver",e);var t=e.target?e.target:e.srcElement,n=e.relatedTarget?e.relatedTarget:e.fromElement;if(P(r,t)&&!P(r,n)&&(s=!0,"function"==typeof l.enterHandler))try{l.enterHandler(l,k(e,r),a,S)}catch(e){xe.error(e.name+" while executing enter handler: "+e.message,e)}}function p(e){e=Ke.getEvent(e);O&&i&&!P(e.srcElement,r)&&g("onMouseOut",e);var t=e.target?e.target:e.srcElement,n=e.relatedTarget?e.relatedTarget:e.toElement;if(P(r,t)&&!P(r,n)&&(s=!1,"function"==typeof l.exitHandler))try{l.exitHandler(l,k(e,r),a,S)}catch(e){xe.error(e.name+" while executing exit handler: "+e.message,e)}}function m(e){if(2!=(e=Ke.getEvent(e)).button){if(a=!0,u=L(e),h=u,c=(new Date).getTime(),"function"==typeof l.pressHandler)try{l.pressHandler(l,k(e,r))}catch(e){xe.error(e.name+" while executing press handler: "+e.message,e)}(l.pressHandler||l.dragHandler)&&Ke.cancelEvent(e),O&&C?O&&H.push(t):(i||(O?(Ke.removeEvent(r,"mouseup",v,!1),Ke.addEvent(r,"mouseup",y,!0),Ke.addEvent(r,"mousemove",E,!0)):(Ke.addEvent(ve,"mouseup",w,!0),Ke.addEvent(ve,"mousemove",T,!0)),i=!0),C=!0,H=[t])}}function v(e){e=Ke.getEvent(e);var t=a,n=s;if(2!=e.button){if(a=!1,"function"==typeof l.releaseHandler)try{l.releaseHandler(l,k(e,r),t,n)}catch(e){xe.error(e.name+" while executing release handler: "+e.message,e)}t&&n&&function(e){if(2==(e=Ke.getEvent(e)).button)return;var t=(new Date).getTime()-c,n=L(e),i=h.distanceTo(n),o=t<=Ge.clickTimeThreshold&&i<=Ge.clickDistThreshold;if("function"==typeof l.clickHandler)try{l.clickHandler(l,k(e,r),o,e.shiftKey)}catch(e){xe.error(e.name+" while executing click handler: "+e.message,e)}}(e)}}function y(e){if(2!=(e=Ke.getEvent(e)).button){for(var t=0;t<H.length;t++){var n=H[t];n.hasMouse()||n.onMouseUp(e)}f(),C=!1,e.srcElement.fireEvent("on"+e.type,ye.createEventObject(e)),Ke.stopEvent(e)}}function w(e){s||v(e),f()}function x(e){l.clickHandler&&Ke.cancelEvent(e)}function T(e){var t=L(e=Ke.getEvent(e)),n=t.minus(u);if(u=t,"function"==typeof l.dragHandler){try{l.dragHandler(l,k(e,r),n,e.shiftKey)}catch(e){xe.error(e.name+" while executing drag handler: "+e.message,e)}Ke.cancelEvent(e)}}function E(e){for(var t=0;t<H.length;t++)H[t].onMouseMove(e);Ke.stopEvent(e)}function b(e){e=Ke.getEvent(e);var t=Ke.getMouseScroll(e);if("function"==typeof l.scrollHandler){if(t)try{l.scrollHandler(l,k(e,r),t,e.shiftKey)}catch(e){xe.error(e.name+" while executing scroll handler: "+e.message,e)}Ke.cancelEvent(e)}}this.target=r,this.enterHandler=null,this.exitHandler=null,this.pressHandler=null,this.releaseHandler=null,this.clickHandler=null,this.dragHandler=null,this.scrollHandler=null,t={hasMouse:e,onMouseOver:d,onMouseOut:p,onMouseUp:v,onMouseMove:T},this.isTracking=function(){return n},this.setTracking=function(e){e?n||(Ke.addEvent(r,"mouseover",d,!1),Ke.addEvent(r,"mouseout",p,!1),Ke.addEvent(r,"mousedown",m,!1),Ke.addEvent(r,"mouseup",v,!1),Ke.addEvent(r,"mousewheel",b,!1),Ke.addEvent(r,"click",x,!1),n=!0,M[o]=t):n&&(Ke.removeEvent(r,"mouseover",d,!1),Ke.removeEvent(r,"mouseout",p,!1),Ke.removeEvent(r,"mousedown",m,!1),Ke.removeEvent(r,"mouseup",v,!1),Ke.removeEvent(r,"mousewheel",b,!1),Ke.removeEvent(r,"click",x,!1),f(),n=!1,delete M[o])}}}function L(e){return Ke.getMousePosition(e)}function k(e,t){var n=Ke.getMousePosition(e),i=Ke.getElementPosition(t);return n.minus(i)}function P(e,t){for(var n=ye.body;t&&e!=t&&n!=t;)try{t=t.parentNode}catch(e){return!1}return e==t}function e(){S=!0}function t(){S=!1}}();var T,be,Oe,k,P,z,I,Se=w.EventManager=function(){var o={};this.addListener=function(e,t){"function"==typeof t&&(o[e]||(o[e]=[]),o[e].push(t))},this.removeListener=function(e,t){var n=o[e];if("function"==typeof t&&n)for(var i=0;i<n.length;i++)if(t==n[i])return void n.splice(i,1)},this.clearListeners=function(e){o[e]&&delete o[e]},this.trigger=function(t){var e=o[t],n=[];if(e){for(var i=1;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<e.length;i++)try{e[i].apply(ve,n)}catch(e){xe.error(e.name+" while executing "+t+" handler: "+e.message,e)}}}};!function(){function r(t,n){var i=null,o=null;function r(e){i.onload=null,i.onabort=null,i.onerror=null,o&&ve.clearTimeout(o),ve.setTimeout(function(){n(t,e?i:null)},1)}this.start=function(){function e(){r(!1)}(i=new Image).onload=function(){r(!0)},i.onabort=e,i.onerror=e,o=ve.setTimeout(function(){xe.log("Image timed out: "+t),r(!1)},15e3),i.src=t}}T=w.ImageLoader=function(){var i=0;function o(e,t,n){if(i--,"function"==typeof e)try{e(n)}catch(e){xe.error(e.name+" while executing "+t+" callback: "+e.message,e)}}this.loadImage=function(e,t){if(i>=Ge.imageLoaderLimit)return!1;var n=new r(e,Ke.createCallback(null,o,t));return i++,n.start(),!0}}}(),k=0,P=1,z=2,I=3,be=w.Button=function(i,e,t,n,o,r,l,a,s,u){var c=Ke.makeNeutralElement("span"),h=P,f=new Ee(c),g=Ke.makeTransparentImage(e),d=Ke.makeTransparentImage(t),p=Ke.makeTransparentImage(n),m=Ke.makeTransparentImage(o),v=(r="function"==typeof r?r:null,l="function"==typeof l?l:null,a="function"==typeof a?a:null,s="function"==typeof s?s:null,u="function"==typeof u?u:null,0),y=2e3,w=null,x=!1;function T(){ve.setTimeout(E,20)}function E(){if(x){var e=1-((new Date).getTime()-w)/y;e=We.min(1,e),e=We.max(0,e),Ke.setElementOpacity(d,e,!0),0<e&&T()}}function b(e){P<=e&&h==k&&(x=!1,Ke.setElementOpacity(d,1,!0),h=P),z<=e&&h==P&&(p.style.visibility="",h=z),I<=e&&h==z&&(m.style.visibility="",h=I)}function O(e){e<=z&&h==I&&(m.style.visibility="hidden",h=z),e<=P&&h==z&&(p.style.visibility="hidden",h=P),e<=k&&h==P&&(x=!0,w=(new Date).getTime()+v,ve.setTimeout(T,v),h=k)}function S(e,t,n,i){n?(b(I),s&&s()):i||b(z)}function C(e,t,n,i){O(P),n&&u&&u()}function M(e,t){b(I),r&&r()}function H(e,t,n,i){n&&i?(O(z),l&&l()):n?O(P):b(z)}function L(e,t,n,i){a&&n&&a()}this.elmt=c,this.notifyGroupEnter=function(){b(P)},this.notifyGroupExit=function(){O(k)},function(){c.style.display="inline-block",c.style.position="relative",c.title=i,c.appendChild(g),c.appendChild(d),c.appendChild(p),c.appendChild(m),g.style;var e=d.style,t=p.style,n=m.style;e.position=t.position=n.position="absolute",e.top=t.top=n.top="0px",e.left=t.left=n.left="0px",t.visibility=n.visibility="hidden",Ke.getBrowser()==Ye.FIREFOX&&Ke.getBrowserVersion()<3&&(e.top=t.top=n.top=""),f.enterHandler=S,f.exitHandler=C,f.pressHandler=M,f.releaseHandler=H,f.clickHandler=L,f.setTracking(!0),O(k)}()},Oe=w.ButtonGroup=function(r){var t=Ke.makeNeutralElement("span"),n=(r=r.concat([]),new Ee(t));function i(e,t,n,i){for(var o=0;o<r.length;o++)r[o].notifyGroupEnter()}function o(e,t,n,i){if(!n)for(var o=0;o<r.length;o++)r[o].notifyGroupExit()}function l(e,t,n,i){if(!i)for(var o=0;o<r.length;o++)r[o].notifyGroupExit()}this.elmt=t,this.emulateEnter=function(){i()},this.emulateExit=function(){o()},function(){t.style.display="inline-block";for(var e=0;e<r.length;e++)t.appendChild(r[e].elmt);n.enterHandler=i,n.exitHandler=o,n.releaseHandler=l,n.setTracking(!0)}()};var l=w.TileSource=function(o,r,e,t,n,i){var u=this,l=r/o;this.width=o,this.height=r,this.aspectRatio=o/r,this.dimensions=new qe(o,r),this.minLevel=n||0,this.maxLevel=i||We.ceil(We.log(We.max(o,r))/We.log(2)),this.tileSize=e||0,this.tileOverlap=t||0,this.getLevelScale=function(e){return 1/(1<<u.maxLevel-e)},this.getNumTiles=function(e){var t=u.getLevelScale(e),n=We.ceil(t*o/u.tileSize),i=We.ceil(t*r/u.tileSize);return new qe(n,i)},this.getPixelRatio=function(e){var t=u.dimensions.times(u.getLevelScale(e)),n=1/t.x,i=1/t.y;return new qe(n,i)},this.getTileAtPoint=function(e,t){var n,i,o=u.dimensions.times(u.getLevelScale(e)),r=t.times(o.x);return n=0<=t.x&&t.x<=1?We.floor(r.x/u.tileSize):We.ceil(o.x/u.tileSize)*We.floor(r.x/o.x)+We.floor((o.x+r.x%o.x)%o.x/u.tileSize),i=0<=t.y&&t.y<=l?We.floor(r.y/u.tileSize):We.ceil(o.y/u.tileSize)*We.floor(r.y/o.y)+We.floor((o.y+r.y%o.y)%o.y/u.tileSize),new qe(n,i)},this.getTileBounds=function(e,t,n){var i=u.dimensions.times(u.getLevelScale(e)),o=0===t?0:u.tileSize*t-u.tileOverlap,r=0===n?0:u.tileSize*n-u.tileOverlap,l=u.tileSize+(0===t?1:2)*u.tileOverlap,a=u.tileSize+(0===n?1:2)*u.tileOverlap;l=We.min(l,i.x-o),a=We.min(a,i.y-r);var s=1/i.x;return new x(o*s,r*s,l*s,a*s)},this.getTileUrl=function(e,t,n){throw new Error("Method not implemented.")},this.tileExists=function(e,t,n){var i=u.getNumTiles(e);return e>=u.minLevel&&e<=u.maxLevel&&0<=t&&0<=n&&t<i.x&&n<i.y}},d=w.DisplayRect=function(e,t,n,i,o,r){x.apply(this,arguments),this.minLevel=o,this.maxLevel=r};d.prototype=new x;var Ce=w.DziTileSource=function(e,t,h,n,i,o,r){l.apply(this,[e,t,h,n]);var f=this,g={};this.fileFormat=o,this.tileFormat=o,this.displayRects=r,function(){if(r)for(var e=r.length-1;0<=e;e--)for(var t=r[e],n=t.minLevel;n<=t.maxLevel;n++)g[n]||(g[n]=[]),g[n].push(t)}(),this.getTileUrl=function(e,t,n){return[i,e,"/",t,"_",n,".",o].join("")},this.tileExists=function(e,t,n){var i=g[e];if(!i||!i.length)return!0;for(var o=f.getLevelScale(e),r=i.length-1;0<=r;r--){var l=i[r];if(!(e<l.minLevel||e>l.maxLevel)){var a=l.x*o,s=l.y*o,u=a+l.width*o,c=s+l.height*o;if(a=We.floor(a/h),s=We.floor(s/h),u=We.ceil(u/h),c=We.ceil(c/h),a<=t&&t<u&&s<=n&&n<c)return!0}}return!1}};Ce.prototype=new l,function(){function g(e){Error.apply(this,arguments),this.message=e}function c(e){return e instanceof g||(xe.error(e.name+" while creating DZI from XML: "+e.message),e=new g(we.getString("Errors.Unknown"))),e}function h(e){var t=e.split("/"),n=t[t.length-1],i=n.lastIndexOf(".");return-1<i&&(t[t.length-1]=n.slice(0,i)),t.join("/")+"_files/"}function s(e,t){if(!e)throw new g(we.getString("Errors.Security"));if(200!==e.status&&0!==e.status){var n=e.status,i=404==n?"Not Found":e.statusText;throw new g(we.getString("Errors.Status",n,i))}var o=null;return e.responseXML&&e.responseXML.documentElement?o=e.responseXML:e.responseText&&(o=Ke.parseXml(e.responseText)),u(o,t)}function u(e,t){if(!e||!e.documentElement)throw new g(we.getString("Errors.Xml"));var n=e.documentElement,i=n.tagName;if("Image"==i)try{return function(e,t){var n=e.getAttribute("Format");if(!Ke.imageFormatSupported(n))throw new g(we.getString("Errors.ImageFormat",n.toUpperCase()));for(var i=e.getElementsByTagName("Size")[0],o=e.getElementsByTagName("DisplayRect"),r=parseInt(i.getAttribute("Width"),10),l=parseInt(i.getAttribute("Height"),10),a=parseInt(e.getAttribute("TileSize")),s=parseInt(e.getAttribute("Overlap")),u=[],c=0;c<o.length;c++){var h=o[c],f=h.getElementsByTagName("Rect")[0];u.push(new d(parseInt(f.getAttribute("X"),10),parseInt(f.getAttribute("Y"),10),parseInt(f.getAttribute("Width"),10),parseInt(f.getAttribute("Height"),10),parseInt(h.getAttribute("MinLevel"),10),parseInt(h.getAttribute("MaxLevel"),10)))}return new Ce(r,l,a,s,t,n,u)}(n,t)}catch(e){var o=we.getString("Errors.Dzi");throw e instanceof g?e:new g(o)}else{if("Collection"==i)throw new g(we.getString("Errors.Dzc"));if("Error"==i)return function(e){throw new g(e.getElementsByTagName("Message")[0].firstChild.nodeValue)}(n)}throw new g(we.getString("Errors.Dzi"))}g.prototype=new Error,Ce.getTilesUrl=h,Ce.createFromJson=function(e,t){var n,i,o="function"==typeof t,r=e;if(r&&(r.url||r.tilesUrl))try{var l=r.displayRects;if(l&&l.length)for(var a=0,s=l.length;a<s;a++){var u=l[a];l[a]=new d(u.x||u[0],u.y||u[1],u.width||u[2],u.height||u[3],u.minLevel||u[4],u.maxLevel||u[5])}(n=new Ce(r.width,r.height,r.tileSize,r.tileOverlap,r.tilesUrl||h(r.url),r.tileFormat,r.displayRects)).xmlUrl=r.url}catch(e){i=c(e)}else i=new g(we.getString("Errors.Empty"));if(!o){if(i)throw i;return n}ve.setTimeout(Ke.createCallback(null,t,n,i&&i.message),1)},Ce.createFromXml=function(i,t,n){var o="function"==typeof n,r=null;if(!i){if(r=we.getString("Errors.Empty"),o)return ve.setTimeout(function(){n(null,r)},1),null;throw new g(r)}var l=h(i);function a(e,t){try{var n=e(t,l);return n.xmlUrl=i,n}catch(e){if(o)return r=c(e).message,null;throw c(e)}}return o?(t?ve.setTimeout(function(){var e=a(u,Ke.parseXml(t));n(e,r)},1):Ke.makeAjaxRequest(i,function(e){var t=a(s,e);n(t,r)}),null):t?a(u,Ke.parseXml(t)):a(s,Ke.makeAjaxRequest(i))}}();var Me,r,He,Le=w.Viewport=function(u,n){var c=this,i=(u=new qe(u.x,u.y),n.x/n.y),s=n.y/n.x,h=new e(0),f=new e(0),l=new e(Ge.logarithmicZoom?0:1),g=null,o=new x(0,0,1,s),r=o.getCenter(),t=We.LN2;function a(e){return We.log(e)/t}function d(e){return We.pow(2,e)}function p(e,t,n){return We.min(We.max(e,t),n)}function m(e){var t=1/c.getZoom(e),n=t/c.getAspectRatio(),i=Ge.visibilityRatio,o=(i-.5)*t,r=(i-.5)*n,l=1-2*o,a=s-2*r;return l<0&&(o+=.5*l,l=0),a<0&&(r+=.5*a,a=0),new w.Rect(o,r,l,a)}this.getHomeBounds=function(){var e=c.getAspectRatio(),t=new x(o.x,o.y,o.width,o.height);return e<=i?(t.height=o.width/e,t.y=r.y-t.height/2):(t.width=o.height*e,t.x=r.x-t.width/2),t},this.getHomeCenter=function(){return r},this.getHomeZoom=function(){var e=i/c.getAspectRatio();return 1<=e?1:e},this.getMinCenter=function(e){return m(e).getTopLeft()},this.getMaxCenter=function(e){return m(e).getBottomRight()},this.getMinZoom=function(){var e=c.getHomeZoom();if(Ge.minZoomDimension)var t=n.x<=n.y?Ge.minZoomDimension/u.x:Ge.minZoomDimension/(u.x*s);else t=Ge.minZoomImageRatio*e;return We.min(t,e)},this.getMaxZoom=function(){var e=n.x*Ge.maxZoomPixelRatio/u.x;return We.max(e,c.getHomeZoom())},this.getAspectRatio=function(){return u.x/u.y},this.getContainerSize=function(){return new qe(u.x,u.y)},this.getBounds=function(e){var t=c.getCenter(e),n=1/c.getZoom(e),i=n/c.getAspectRatio();return new x(t.x-n/2,t.y-i/2,n,i)},this.getCenter=function(e){var t=new qe(h.getCurrent(),f.getCurrent()),n=new qe(h.getTarget(),f.getTarget());if(e)return t;if(!g)return n;var i=c.getZoom(),o=1/i,r=o/c.getAspectRatio(),l=new x(t.x-o/2,t.y-r/2,o,r),a=c.pixelFromPoint(g,!0),s=g.minus(l.getTopLeft()).times(u.x/l.width).minus(a).divide(u.x*i);return n.plus(s)},this.getZoom=function(e){var t;return t=e?l.getCurrent():l.getTarget(),Ge.logarithmicZoom?d(t):t},this.applyConstraints=function(e){var t=c.getZoom(),n=p(t,c.getMinZoom(),c.getMaxZoom());t!=n&&c.zoomTo(n,g,e);var i=c.getCenter(),o=function(e,t){var n=e.x,i=e.y,o=p(n,t.x,t.x+t.width),r=p(i,t.y,t.y+t.height);return n===o&&i===r?e:new qe(o,r)}(i,m());if(Ge.wrapHorizontal&&(o.x=i.x),Ge.wrapVertical&&(o.y=i.y),!i.equals(o)){var r=1/n,l=r/c.getAspectRatio();c.fitBounds(new x(o.x-.5*r,o.y-.5*l,r,l),e)}},this.ensureVisible=function(e){c.applyConstraints(e)},this.fitBounds=function(e,t){var n=c.getAspectRatio(),i=e.getCenter(),o=new x(e.x,e.y,e.width,e.height);o.getAspectRatio()>=n?(o.height=e.width/n,o.y=i.y-o.height/2):(o.width=e.height*n,o.x=i.x-o.width/2),c.panTo(c.getCenter(!0),!0),c.zoomTo(c.getZoom(!0),null,!0);var r=c.getBounds(),l=c.getZoom(),a=1/o.width;if(a!=l&&o.width!=r.width){var s=r.getTopLeft().times(u.x/r.width).minus(o.getTopLeft().times(u.x/o.width)).divide(u.x/r.width-u.x/o.width);c.zoomTo(a,s,t)}else c.panTo(i,t)},this.goHome=function(e){var t=c.getCenter();Ge.wrapHorizontal&&(t.x=(1+t.x%1)%1,h.resetTo(t.x),h.update()),Ge.wrapVertical&&(t.y=(s+t.y%s)%s,f.resetTo(t.y),f.update()),c.fitBounds(o,e)},this.panBy=function(e,t){c.panTo(c.getCenter().plus(e),t)},this.panTo=function(e,t){if(t)return h.resetTo(e.x),void f.resetTo(e.y);if(!g)return h.springTo(e.x),void f.springTo(e.y);var n=c.getZoom(),i=1/n,o=i/c.getAspectRatio(),r=new x(h.getCurrent()-i/2,f.getCurrent()-o/2,i,o),l=c.pixelFromPoint(g,!0),a=g.minus(r.getTopLeft()).times(u.x/r.width).minus(l).divide(u.x*n),s=e.minus(a);h.springTo(s.x),f.springTo(s.y)},this.zoomBy=function(e,t,n){c.zoomTo(c.getZoom()*e,t,n)},this.zoomTo=function(e,t,n){n?l.resetTo(Ge.logarithmicZoom?a(e):e):l.springTo(Ge.logarithmicZoom?a(e):e),g=t instanceof qe?t:null},this.resize=function(e,t){var n=c.getBounds(),i=n,o=e.x/u.x;u=new qe(e.x,e.y),t&&(i.width=n.width*o,i.height=i.width/c.getAspectRatio()),c.fitBounds(i,!0)},this.update=function(){var e=h.getCurrent(),t=f.getCurrent(),n=l.getCurrent();if(g)var i=c.pixelFromPoint(g,!0);if(l.update(),g&&l.getCurrent()!=n){var o=c.pixelFromPoint(g,!0).minus(i),r=c.deltaPointsFromPixels(o,!0);h.shiftBy(r.x),f.shiftBy(r.y)}else g=null;return h.update(),f.update(),h.getCurrent()!=e||f.getCurrent()!=t||l.getCurrent()!=n},this.deltaPixelsFromPoints=function(e,t){return e.times(u.x*c.getZoom(t))},this.deltaPointsFromPixels=function(e,t){return e.divide(u.x*c.getZoom(t))},this.pixelFromPoint=function(e,t){var n=c.getBounds(t);return e.minus(n.getTopLeft()).times(u.x/n.width)},this.pointFromPixel=function(e,t){var n=c.getBounds(t);return e.divide(u.x/n.width).plus(n.getTopLeft())},c.goHome(!0),c.update()};!function(){for(var a,l,je=Ke.getBrowser(),e=Ke.getBrowserVersion(),t=(navigator.userAgent,!!ye.createElement("canvas").getContext),n=(ye.documentElement||{}).style||{},s=!1,i=["msTransform","WebkitTransform","MozTransform"];a=i.shift();)if(void 0!==n[a]){s=!0,l=/webkit/i.test(a);break}n.WebkitTransition,new RegExp("progid:DXImageTransform.Microsoft.Matrix\\(.*?\\)","g"),function(){try{je==Ye.IE&&ye.documentElement.filters}catch(e){return}}();var Ve=t&&!(je==Ye.SAFARI&&e<4||je==Ye.CHROME),u=!Ve&&s,c=void 0!==ye.documentMode?"bicubic":"nearest-neighbor";function v(e,t,n,i,o,r){this.level=e,this.x=t,this.y=n,this.bounds=i,this.exists=o,this.url=r,this.elmt=null,this.image=null,this.loaded=!1,this.loading=!1,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.distance=null,this.visibility=null,this.beingDrawn=!1,this.lastDrawnTime=0,this.lastTouchTime=0}function o(e){switch(e){case r.TOP_LEFT:return function(e,t){};case r.TOP:return function(e,t){e.x-=t.x/2};case r.TOP_RIGHT:return function(e,t){e.x-=t.x};case r.RIGHT:return function(e,t){e.x-=t.x,e.y-=t.y/2};case r.BOTTOM_RIGHT:return function(e,t){e.x-=t.x,e.y-=t.y};case r.BOTTOM:return function(e,t){e.x-=t.x/2,e.y-=t.y};case r.BOTTOM_LEFT:return function(e,t){e.y-=t.y};case r.LEFT:return function(e,t){e.y-=t.y/2};case r.CENTER:default:return function(e,t){e.x-=t.x/2,e.y-=t.y/2}}}function h(e,t,n){this.elmt=e,this.scales=t instanceof x,this.bounds=new x(t.x,t.y,t.width,t.height),this.adjust=o(t instanceof qe?n:r.TOP_LEFT),this.position=new qe(t.x,t.y),this.size=new qe(t.width,t.height),this.style=e.style,this.naturalSize=new qe(e.clientWidth,e.clientHeight)}v.prototype.toString=function(){return this.level+"/"+this.x+"_"+this.y},v.prototype.drawHTML=function(e){if(this.loaded){this.elmt||(this.elmt=Ke.makeNeutralElement("img"),this.elmt.src=this.url,this.style=this.elmt.style,this.style.position="absolute",this.style.msInterpolationMode=c,u&&(this.style[a+"Origin"]="0px 0px"));var t=this.elmt,n=this.image,i=this.style,o=this.position,r=this.size;if(t.parentNode!=e&&e.appendChild(t),u)i[a]=["matrix(",(r.x/n.width).toFixed(8),",0,0,",(r.y/n.height).toFixed(8),",",o.x.toFixed(8),l?",":"px,",o.y.toFixed(8),l?")":"px)"].join("");else o=o.apply(We.floor),r=r.apply(We.ceil),i.left=o.x+"px",i.top=o.y+"px",i.width=r.x+"px",i.height=r.y+"px";Ke.setElementOpacity(t,this.opacity)}else xe.error("Attempting to draw tile "+this.toString()+" when it's not yet loaded.")},v.prototype.drawCanvas=function(e){if(this.loaded){var t=this.position,n=this.size;e.globalAlpha=this.opacity,e.drawImage(this.image,t.x,t.y,n.x,n.y)}else xe.error("Attempting to draw tile "+this.toString()+" when it's not yet loaded.")},v.prototype.unload=function(){this.elmt&&this.elmt.parentNode&&this.elmt.parentNode.removeChild(this.elmt),this.elmt=null,this.image=null,this.loaded=!1,this.loading=!1},r=w.OverlayPlacement={CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8},h.prototype.destroy=function(){var e=this.elmt,t=this.style;e.parentNode&&e.parentNode.removeChild(e),t.top="",t.left="",t.position="",this.scales&&(t.width="",t.height="")},h.prototype.drawHTML=function(e){var t=this.elmt,n=this.style,i=this.scales,o=this.naturalSize;t.parentNode!=e&&(e.appendChild(t),n.position="absolute",o.x=t.clientWidth,o.y=t.clientHeight);var r=this.position,l=this.size;(i||(l.x=o.x=o.x||t.clientWidth,l.y=o.y=o.y||t.clientHeight),this.adjust(r,l),Ge.transformOverlays&&s)?(n[a+"Origin"]="0px 0px",n[a]=["translate(",r.x.toFixed(8),"px,",r.y.toFixed(8),"px)"].join(""),i&&(t.clientWidth||(n.width="100%"),t.clientHeight||(n.height="100%"),n[a]+=[" scale(",(l.x/t.clientWidth).toFixed(8),",",(l.y/t.clientHeight).toFixed(8),")"].join(""))):(Ge.transformOverlays,r=r.apply(We.floor),l=l.apply(We.ceil),n.left=r.x+"px",n.top=r.y+"px",i&&(n.width=l.x+"px",n.height=l.y+"px"))},h.prototype.update=function(e,t){this.scales=e instanceof x,this.bounds=new x(e.x,e.y,e.width,e.height),this.adjust=o(e instanceof qe?t:r.TOP_LEFT)},Me=w.Drawer=function(Ee,be,e){var Oe=Ke.getElement(e),Se=Ke.makeNeutralElement(Ve?"canvas":"div"),Ce=Ve?Se.getContext("2d"):null,Me=new T,t=new Te,He=Ee.minLevel,Le=Ee.maxLevel,g=Ee.tileSize,ke=Ee.tileOverlap,Pe=Ee.height/Ee.width,n={},i={},f={},d=[],a={},ze=[],Ie=[],Fe=0,p=0,m=!1,Re=!0;function De(e){return n[e]||(n[e]=Ee.getNumTiles(e)),n[e]}function Be(e){return i[e]||(i[e]=Ee.getPixelRatio(e)),i[e]}function Ne(e,t,n,i,o,r){if(f[e]||(f[e]={}),f[e][t]||(f[e][t]={}),!f[e][t][n]){var l=(o+t%o)%o,a=(r+n%r)%r,s=Ee.getTileBounds(e,l,a),u=Ee.tileExists(e,l,a),c=Ee.getTileUrl(e,l,a);s.x+=1*(t-l)/o,s.y+=Pe*(n-a)/r,f[e][t][n]=new v(e,t,n,s,u,c)}var h=f[e][t][n];return h.lastTouchTime=i,h}function Ae(e,t,n){if(e.loading=!1,m)xe.error("Tile load callback in middle of drawing routine.");else{if(!n)return xe.log("Tile "+e+" failed to load: "+e.url),void(e.exists=!1);if(t<p)xe.log("Ignoring tile "+e+" loaded before reset: "+e.url);else{e.loaded=!0,e.image=n;var i=d.length;if(100<=d.length){for(var o=We.ceil(We.log(g)/We.log(2)),r=null,l=-1,a=d.length-1;0<=a;a--){var s=d[a];if(!(s.level<=o||s.beingDrawn))if(r){var u=s.lastTouchTime,c=r.lastTouchTime,h=s.level,f=r.level;(u<c||u==c&&f<h)&&(r=s,l=a)}else r=s,l=a}r&&0<=l&&(r.unload(),i=l)}d[i]=e,Re=!0}}}function Xe(e,t,n){if(!a[e])return!1;if(t!==y&&n!==y)return a[e][t]===y||a[e][t][n]===y||!0===a[e][t][n];var i=a[e];for(var o in i)if(i.hasOwnProperty(o)){var r=i[o];for(var l in r)if(r.hasOwnProperty(l)&&!r[l])return!1}return!0}function Ze(e,t,n){return t===y||n===y?Xe(e+1):Xe(e+1,2*t,2*n)&&Xe(e+1,2*t,2*n+1)&&Xe(e+1,2*t+1,2*n)&&Xe(e+1,2*t+1,2*n+1)}function Ue(e,t,n,i){a[e]?(a[e][t]||(a[e][t]={}),a[e][t][n]=i):xe.error("Setting coverage for a tile before its level's coverage has been reset: "+e)}function _e(e){a[e]={}}function o(e){for(var t=ze.length-1;0<=t;t--)if(ze[t].elmt==e)return t;return-1}function r(){Re=!1;for(var e=Se,t=Ce,n=Ve,i=Ie;0<i.length;){(re=i.pop()).beingDrawn=!1}var o=be.getContainerSize(),r=o.x,l=o.y;n?(e.width=r,e.height=l,t.clearRect(0,0,r,l)):e.innerHTML="";var a=be.getBounds(!0),s=a.getTopLeft(),u=a.getBottomRight();if((Ge.wrapHorizontal||!(u.x<0||1<s.x))&&(Ge.wrapVertical||!(u.y<0||s.y>Pe))){var c=De,h=Be,f=Ne,g=Ze,d=Ue,p=_e,m=Xe,v=ke,y=Fe,w=je===Ye.CHROME,x=We.abs,T=(We.ceil,We.floor),E=We.log,b=We.max,O=We.min,S=be.deltaPixelsFromPoints,C=be.pixelFromPoint,M=Ee.getTileAtPoint,H=Ge.alwaysBlend,L=1e3*Ge.blendTime,k=Ge.immediateRender,P=Ge.minZoomDimension,z=(Ge.minImageRatio,Ge.wrapHorizontal),I=Ge.wrapVertical,F=Ge.wrapOverlays;z||(s.x=b(s.x,0),u.x=O(u.x,1)),I||(s.y=b(s.y,0),u.y=O(u.y,Pe));var R,D,B=null,N=!1,A=(new Date).getTime(),X=be.getCenter(),Z=C(X),U=S(h(0),!1).x,_=k?1:U,j=b(He,T(E(P=P||64)/E(2))),V=S(h(0),!0).x,W=O(Le,T(E(V/.5)/E(2)));j=O(j,W);for(var G=W;j<=G;G--){var q=!1,Y=S(h(G),!0).x;if(!N&&.5<=Y||G==j)N=q=!0;else if(!N)continue;p(G);var K=O(1,(Y-.5)/.5),J=_/x(_-S(h(G),!1).x),Q=M(G,s),$=M(G,u),ee=c(G),te=ee.x,ne=ee.y;z||($.x=O($.x,te-1)),I||($.y=O($.y,ne-1));for(var ie=Q.x;ie<=$.x;ie++)for(var oe=Q.y;oe<=$.y;oe++){var re=f(G,ie,oe,A,te,ne),le=q;if(d(G,ie,oe,!1),re.exists&&(N&&!le&&(g(G,ie,oe)?d(G,ie,oe,!0):le=!0),le)){var ae=re.bounds.getTopLeft(),se=re.bounds.getSize(),ue=C(ae,!0),ce=S(se,!0);v||(ce=ce.plus(new qe(1,1)));var he=C(ae,!1),fe=S(se,!1),ge=he.plus(fe.divide(2)),de=Z.distanceTo(ge);if(re.position=ue,re.size=ce,re.distance=de,re.visibility=J,re.loaded){re.blendStart||(re.blendStart=A);var pe=A-re.blendStart,me=0==L?1:O(1,pe/L);H&&(me*=K),re.opacity=me,i.push(re),1<=me?(d(G,ie,oe,!0),w&&re.lastDrawnTime!==y&&d(G,ie,oe,!1)):pe<L&&(Re=!0),re.lastDrawnTime=A}else re.loading||(D=re,B=(R=B)?D.visibility>R.visibility?D:D.visibility==R.visibility&&D.distance<R.distance?D:R:D)}}if(m(G))break}for(var ve=i.length-1;0<=ve;ve--){re=i[ve];n?re.drawCanvas(t):re.drawHTML(e),re.beingDrawn=!0}var ye=ze.length;for(ve=0;ve<ye;ve++){var we=ze[ve],xe=we.bounds,Te=xe.getTopLeft();F&&z&&(Te.x+=T(X.x)),we.position=C(Te,!0),we.size=S(xe.getSize(),!0),we.drawHTML(Oe)}B&&(function(e,t){e.loading=Me.loadImage(e.url,Ke.createCallback(null,Ae,e,t))}(B,A),Re=!0),Fe=A}}this.elmt=Oe,this.profiler=t,Se.style.width="100%",Se.style.height="100%",Se.style.position="absolute",Oe.style.textAlign="left",Oe.appendChild(Se),this.addOverlay=function(e,t,n){0<=o(e=Ke.getElement(e))||(ze.push(new h(e,t,n)),Re=!0)},this.updateOverlay=function(e,t,n){var i=o(e=Ke.getElement(e));0<=i&&(ze[i].update(t,n),Re=!0)},this.removeOverlay=function(e){var t=o(e=Ke.getElement(e));0<=t&&(ze[t].destroy(),ze.splice(t,1),Re=!0)},this.clearOverlays=function(){for(;0<ze.length;)ze.pop().destroy(),Re=!0},this.needsUpdate=function(){return Re},this.numTilesLoaded=function(){return d.length},this.reset=function(){f={},d=[],p=(new Date).getTime(),Re=!0},this.update=function(){t.beginUpdate(),m=!0,r(),m=!1,t.endUpdate()},this.idle=function(){}}}(),function(){var ae="----seadragon----",t=Ke.getBrowser();function se(e,t,n){var i=Ke.makeNeutralElement("span");this.elmt=e,this.anchor=t,this.container=n,(this.wrapper=i).style.display="inline-block",i.appendChild(e),t==He.NONE&&(i.style.width=i.style.height="100%"),function(e,t,n){t==He.TOP_RIGHT||t==He.BOTTOM_RIGHT?n.insertBefore(e,n.firstChild):n.appendChild(e)}(i,t,n)}He=w.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4},se.prototype.destroy=function(){this.wrapper.removeChild(this.elmt),this.container.removeChild(this.wrapper)},se.prototype.isVisible=function(){return"none"!=this.wrapper.style.display},se.prototype.setVisible=function(e){this.wrapper.style.display=e?"inline-block":"none"},se.prototype.setOpacity=function(e){this.elmt[ae]&&t==Ye.IE?Ke.setElementOpacity(this.elmt,e,!0):Ke.setElementOpacity(this.wrapper,e,!0)};var ue="fullpage",ce="home",he="zoomin",fe="zoomout",ge="_rest.png",de="_grouphover.png",pe="_hover.png",me="_pressed.png";w.Viewer=function(s){var e,t,n,i,o,r,u=this,c=Ke.getElement(s),h=(s=Ke.makeNeutralElement("div"),Ke.makeNeutralElement("div")),l=Ke.makeNeutralElement("div"),a=Ke.makeNeutralElement("div"),f=Ke.makeNeutralElement("div"),g=Ke.makeNeutralElement("div"),d=null,p=null,m=null,v=null,y=new Se,w=new Ee(h),x=new Ee(s),T=[],E=!0,b=null,O=null,S=1e3,C=2e3,M=(b=null,E=!1,ye.body.style.width),H=ye.body.style.height,L=ye.body.style.overflow,k=ye.documentElement.style.overflow,P=new qe(1,1),z=null,I=0,F=0,R=null,D=null,B=!1,N=!1,A=!1;function X(e){var t=ye.createTextNode(e);h.innerHTML="",h.appendChild(Ke.makeCenteredNode(t));var n=t.parentNode.style;n.fontFamily="verdana",n.fontSize="13px",n.fontSizeAdjust="none",n.fontStyle="normal",n.fontStretch="normal",n.fontVariant="normal",n.fontWeight="normal",n.lineHeight="1em",n.textAlign="center",n.textDecoration="none"}function Z(){return d&&_(),I=(new Date).getTime(),ve.setTimeout(function(){F<I&&X(we.getString("Messages.Loading"))},2e3),I}function U(e,t,n){return F=(new Date).getTime(),e<I?(xe.log("Ignoring out-of-date open."),void y.trigger("ignore",u)):t?(h.innerHTML="",void(0!==(z=Ke.getElementSize(s)).x&&0!==z.y?(m=new Le(z,(d=t).dimensions),p=new Me(d,m,h),v=new Te,u.source=d,u.viewport=m,u.drawer=p,u.profiler=v,N=!(B=!1),j(W),y.trigger("open",u)):ve.setTimeout(function(){U(e,t,n)},10))):(X(n),void y.trigger("error",u))}function _(){u.source=d=null,u.viewport=m=null,u.drawer=p=null,u.profiler=v=null,h.innerHTML=""}function j(e,t){if(B)return ve.setTimeout(e,1);var n=(new Date).getTime(),i=(t=t||n)+1e3/60,o=We.max(1,i-n);return ve.setTimeout(e,o)}function V(){if(d){v.beginUpdate();var e=Ke.getElementSize(s);!e.equals(z)&&0<e.x&&0<e.y&&(m.resize(e,!0),z=e,y.trigger("resize",u));var t=m.update();!B&&t&&(y.trigger("animationstart",u),K()),t?(p.update(),y.trigger("animation",u)):N||p.needsUpdate()?(p.update(),N=!1):p.idle(),B&&!t&&(y.trigger("animationfinish",u),A||J()),B=t,v.endUpdate()}}function W(){if(d){var e=(new Date).getTime();V(),j(arguments.callee,e)}}function G(e){for(var t=T.length-1;0<=t;t--)if(T[t].elmt==e)return t;return-1}function q(){ve.setTimeout(Y,20)}function Y(){if(E){var e=1-((new Date).getTime()-b)/C;e=We.min(1,e),e=We.max(0,e);for(var t=T.length-1;0<=t;t--)T[t].setOpacity(e);0<e&&q()}}function K(){E=!1;for(var e=T.length-1;0<=e;e--)T[e].setOpacity(1)}function J(){Ge.autoHideControls&&(E=!0,b=(new Date).getTime()+S,ve.setTimeout(q,S))}function Q(e,t,n,i){A=!0,K()}function $(e,t,n,i){n||(A=!1,B||J())}function ee(e,t,n,i){i||(A=!1,B||J())}function te(e,t,n,i){if(m&&n){var o=Ge.zoomPerClick,r=i?1/o:o;m.zoomBy(r,m.pointFromPixel(t,!0)),m.applyConstraints()}}function ne(e,t){m&&(R=t,D=m.getCenter())}function ie(e,t,n,i){if(m)if(Ge.constrainDuringPan){var o=t.minus(R),r=m.deltaPointsFromPixels(o.negate(),!0);m.panTo(D.plus(r)),m.applyConstraints()}else m.panBy(m.deltaPointsFromPixels(n.negate(),!0))}function oe(e,t,n,i){n&&m&&m.applyConstraints()}function re(e,t,n,i){if(m){var o=We.pow(Ge.zoomPerScroll,n);m.zoomBy(o,m.pointFromPixel(t,!0)),m.applyConstraints()}}function le(e){27===(e=Ke.getEvent(e)).keyCode&&u.setFullPage(!1)}this.container=c,this.elmt=s,this.source=null,this.drawer=null,this.viewport=null,this.profiler=null,this.tracker=w,this.isOpen=function(){return!!d},this.openDzi=function(e,t){var n=Z(),i=Ke.createCallback(null,U,n);switch(typeof e){case"string":Ce.createFromXml(e,t,i);break;default:Ce.createFromJson(e,i)}},this.openTileSource=function(e){var t=Z();ve.setTimeout(function(){U(t,e)},1)},this.close=function(){d&&_()},this.addControl=function(e,t){if(!(0<=G(e=Ke.getElement(e)))){var n=null;switch(t){case He.TOP_RIGHT:n=a,e.style.position="relative";break;case He.BOTTOM_RIGHT:n=f,e.style.position="relative";break;case He.BOTTOM_LEFT:n=g,e.style.position="relative";break;case He.TOP_LEFT:n=l,e.style.position="relative";break;case He.NONE:default:n=s,e.style.position="absolute"}T.push(new se(e,t,n))}},this.removeControl=function(e){var t=G(e=Ke.getElement(e));0<=t&&(T[t].destroy(),T.splice(t,1))},this.clearControls=function(){for(;0<T.length;)T.pop().destroy()},this.getNavControl=function(){return O},this.isDashboardEnabled=function(){for(var e=T.length-1;0<=e;e--)if(T[e].isVisible())return!0;return!1},this.isFullPage=function(){return s.parentNode==ye.body},this.isMouseNavEnabled=function(){return w.isTracking()},this.isVisible=function(){return"hidden"!=s.style.visibility},this.setDashboardEnabled=function(e){for(var t=T.length-1;0<=t;t--)T[t].setVisible(e)},this.setFullPage=function(e){if(e!=u.isFullPage()){var t=ye.body,n=t.style,i=ye.documentElement.style,o=s.style,r=h.style;if(e?(L=n.overflow,k=i.overflow,n.overflow="hidden",i.overflow="hidden",M=n.width,H=n.height,n.width="100%",n.height="100%",r.backgroundColor="black",r.color="white",o.position="fixed",o.zIndex="99999999",t.appendChild(s),z=Ke.getWindowSize(),Ke.addEvent(ye,"keydown",le),Q()):(n.overflow=L,i.overflow=k,n.width=M,n.height=H,r.backgroundColor="",r.color="",o.position="relative",o.zIndex="",c.appendChild(s),z=Ke.getElementSize(c),Ke.removeEvent(ye,"keydown",le),$()),m){var l=m.getBounds();m.resize(z);var a=m.getBounds();e?P=new qe(a.width/l.width,a.height/l.height):(m.update(),m.zoomBy(We.max(P.x,P.y),null,!0)),N=!0,y.trigger("resize",u),V()}}},this.setMouseNavEnabled=function(e){w.setTracking(e)},this.setVisible=function(e){s.style.visibility=e?"":"hidden"},this.showMessage=function(e,t){t?ve.setTimeout(function(){u.isOpen()||X(e)},t):X(e)},this.addEventListener=function(e,t){y.addListener(e,t)},this.removeEventListener=function(e,t){y.removeListener(e,t)},e=h.style,t=s.style,n=l.style,i=a.style,o=f.style,r=g.style,t.width="100%",t.height="100%",t.position="relative",t.left="0px",t.top="0px",t.textAlign="left",e.width="100%",e.height="100%",e.overflow="hidden",e.position="absolute",e.top="0px",e.left="0px",n.position=i.position=o.position=r.position="absolute",n.top=i.top="0px",n.left=r.left="0px",i.right=o.right="0px",r.bottom=o.bottom="0px",w.clickHandler=te,w.pressHandler=ne,w.dragHandler=ie,w.releaseHandler=oe,w.scrollHandler=re,w.setTracking(!0),(O=function(i){var e=null,o=!1,r=null,l=null;function t(){l=(new Date).getTime(),r=Ge.zoomPerSecond,o=!0,s()}function n(){l=(new Date).getTime(),r=1/Ge.zoomPerSecond,o=!0,s()}function a(){o=!1}function s(){ve.setTimeout(u,10)}function u(){if(o&&i.viewport){var e=(new Date).getTime(),t=e-l,n=We.pow(r,t/1e3);i.viewport.zoomBy(n),i.viewport.applyConstraints(),l=e,s()}}function c(e,t){return Ge.imagePath+e+t}var h=new be(we.getString("Tooltips.ZoomIn"),c(he,ge),c(he,de),c(he,pe),c(he,me),t,a,function(){i.viewport&&(o=!1,i.viewport.zoomBy(Ge.zoomPerClick/1),i.viewport.applyConstraints())},t,a),f=new be(we.getString("Tooltips.ZoomOut"),c(fe,ge),c(fe,de),c(fe,pe),c(fe,me),n,a,function(){i.viewport&&(o=!1,i.viewport.zoomBy(1/Ge.zoomPerClick),i.viewport.applyConstraints())},n,a),g=new be(we.getString("Tooltips.Home"),c(ce,ge),c(ce,de),c(ce,pe),c(ce,me),null,function(){i.viewport&&i.viewport.goHome()},null,null,null),d=new be(we.getString("Tooltips.FullPage"),c(ue,ge),c(ue,de),c(ue,pe),c(ue,me),null,function(){i.setFullPage(!i.isFullPage()),e.emulateExit(),i.viewport&&i.viewport.applyConstraints()},null,null,null);return(e=new Oe([h,f,g,d])).elmt[ae]=!0,i.addEventListener("open",function(){e.emulateEnter(),e.emulateExit()}),e.elmt}(u)).style.marginRight="4px",O.style.marginBottom="4px",u.addControl(O,He.BOTTOM_RIGHT),x.enterHandler=Q,x.exitHandler=$,x.releaseHandler=ee,x.setTracking(!0),ve.setTimeout(J,1),s.appendChild(h),s.appendChild(l),s.appendChild(a),s.appendChild(f),s.appendChild(g),c.innerHTML="",c.appendChild(s)}}()}(window,document,Math);
